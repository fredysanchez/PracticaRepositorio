/*ESCUELA POLITECNICA NACIONAL
  ESCUELA DE FORMACION DE TECNOLOGOS
  ANALISIS DE SISTEMAS INFORMATICOS
  BASE DE DATOS II   GR1
  DISEÑO DE LA BASE DE DATOS
  INTEGRANTES:
	  MALDONADO MORENO LUIS GUSTAVO
	  PEÑAFIEL GARCIA LOURDES BELEN
	  SANCHEZ ARTEAGA FREDY VICENTE
  QUITO, NOVIEMBRE 10 DE 2015*/
--============================= CREACION BASE DE DATOS ============================= 
CREATE DATABASE INVENTARIOS11
GO
USE INVENTARIOS11
GO
--============================= CREACION DE TABLAS ============================= 
CREATE TABLE PROVEEDOR
(
	PR_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	PR_NOMBRE VARCHAR(25)NOT NULL,
	PR_APELLIDO VARCHAR(25)NOT NULL UNIQUE,
	PR_CEDULA VARCHAR(10)NOT NULL CHECK (PR_CEDULA like '[0][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'or
										 PR_CEDULA like '[1][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'or
										 PR_CEDULA like '[2][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'),
	PR_EMPRESA VARCHAR(25)NOT NULL,
)

CREATE TABLE RESPONSABLE
(
	RP_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	RP_NOMBRE VARCHAR(25)NOT NULL,
	RP_APELLIDO VARCHAR(25)NOT NULL UNIQUE,
	RP_CEDULA VARCHAR(10)NOT NULL CHECK (RP_CEDULA like '[0][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'or
										 RP_CEDULA like '[1][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'or
										 RP_CEDULA like '[2][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'),
	RP_CARGO VARCHAR(25)NOT NULL,
)

CREATE TABLE EQUIPOS
(
	EQ_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	EQ_MARCA VARCHAR (25)NOT NULL,
	EQ_VALOR_COMPRA MONEY NOT NULL,
	EQ_FECHA_COMPRA DATE NOT NULL DEFAULT GETDATE(),
	EQ_PERIODO_GARANTIA  VARCHAR (25)NOT NULL,
	EQ_UBICACIÓN_FISICA VARCHAR (25)NOT NULL,
	EQ_ESTADO_ACTUAL VARCHAR(2) NULL CHECK (EQ_ESTADO_ACTUAL  ='FC' or EQ_ESTADO_ACTUAL  ='DN' or EQ_ESTADO_ACTUAL= 'MT'),
	PR_CODIGOFK CHAR(4) NOT NULL REFERENCES PROVEEDOR(PR_CODIGO)
)

CREATE TABLE CAMBIO_RESPONSABLE
(
	CR_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	CR_FECHA_CAMBIO DATE NOT NULL DEFAULT GETDATE(),
	RP_CODIGOFK CHAR(4) NOT NULL REFERENCES RESPONSABLE(RP_CODIGO),
	EQ_CODIGOFK CHAR(4) NOT NULL REFERENCES EQUIPOS(EQ_CODIGO)
)


CREATE TABLE COMPONENTES_X_EQUIPO
(
	CE_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	CE_NOMBRE VARCHAR(25) NOT NULL,
	CE_CAPACIDAD DECIMAL(8,2)NOT NULL,
	CE_TAMAÑO DECIMAL(8,2)NOT NULL,
	CE_PRECIO MONEY NOT NULL CHECK (CE_PRECIO>0),
	EQ_CODIGOFK CHAR(4) NOT NULL REFERENCES EQUIPOS(EQ_CODIGO)
)

CREATE TABLE TECNICO
(
	TC_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	TC_NOMBRE VARCHAR(25)NOT NULL,
	TC_APELLIDO VARCHAR(25)NOT NULL UNIQUE,
	TC_CEDULA VARCHAR(10)NOT NULL CHECK (TC_CEDULA like '[0][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'or
										 TC_CEDULA like '[1][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'or
										 TC_CEDULA like '[2][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'),
)

CREATE TABLE MANTENIMIENTO 
(
	M_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	M_FECHA DATE NOT NULL DEFAULT GETDATE(),
	M_TRABAJO_REALIZADO VARCHAR (25)NOT NULL,
	M_ESTADO_ANTERIOR VARCHAR(15) NULL CHECK ( M_ESTADO_ANTERIOR  ='FC' or M_ESTADO_ANTERIOR ='DN' or M_ESTADO_ANTERIOR= 'MT'),
	M_ESTADO_DESPUES VARCHAR(15) NULL CHECK ( M_ESTADO_DESPUES  ='FC' or M_ESTADO_DESPUES ='DN'),
	TC_CODIGOFK CHAR(4) NOT NULL REFERENCES TECNICO(TC_CODIGO),
	EQ_CODIGOFK CHAR(4) NOT NULL REFERENCES EQUIPOS(EQ_CODIGO)
)

CREATE TABLE COMPONENTES_ADICIONALES
(
	CA_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	CA_MARCA VARCHAR(25)NOT NULL,
	CA_NOMBRE VARCHAR(25)NOT NULL,
	CA_VELOCIDAD VARCHAR(25)NOT NULL,
	CA_TAMAÑO DECIMAL(8,2)NOT NULL,
	CA_CAPACIDAD DECIMAL(8,2)NOT NULL,
	CA_FECHACOMPRA DATE NOT NULL DEFAULT GETDATE(),
	CA_GARANTIA VARCHAR(25)NOT NULL,
	CA_PRECIO MONEY NOT NULL CHECK (CA_PRECIO>0)
)

CREATE TABLE REEMPLAZO_DE_COMPONENTES
(
	RC_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	CA_CODIGOFK CHAR(4) NOT NULL REFERENCES COMPONENTES_ADICIONALES(CA_CODIGO),
	CE_CODIGOFK CHAR(4) NOT NULL REFERENCES COMPONENTES_X_EQUIPO(CE_CODIGO),
	M_CODIGOFK CHAR(4) NOT NULL REFERENCES MANTENIMIENTO(M_CODIGO)
)


CREATE TABLE DE_BAJA
(
	DB_CODIGO CHAR(4) NOT NULL PRIMARY KEY,
	DB_FECHA DATE  NULL,
	DB_CAUSA VARCHAR(50)NOT NULL
)

--============================= SELECCIONES ============================= 
SELECT * FROM [dbo].[CAMBIO_RESPONSABLE]
SELECT * FROM [dbo].[COMPONENTES_ADICIONALES]
SELECT * FROM [dbo].[COMPONENTES_X_EQUIPO]
SELECT * FROM [dbo].[DE_BAJA]
SELECT * FROM [dbo].[EQUIPOS]
SELECT * FROM [dbo].[MANTENIMIENTO]
SELECT * FROM [dbo].[PROVEEDOR]
SELECT * FROM [dbo].[REEMPLAZO_DE_COMPONENTES]
SELECT * FROM [dbo].[RESPONSABLE]
SELECT * FROM [dbo].[TECNICO]

--============================= 4.- EN LA BDD DE INVENTARIO INFORMÁTICO REALIZAR LOS SIGUIENTES TRIGGERS =============================

--CUANDO SE AUMENTA O SE QUITA UN COMPONENTE A UN EQUIPO, EL VALOR DEL EQUIPO DEBE AUMENTAR O DISMINUIR EL VALOR
--DEL COMPONENTE.
CREATE  TRIGGER TR_ADPRECIO_EQUIPO 
ON COMPONENTES_X_EQUIPO AFTER INSERT
AS
DECLARE @CODIGO CHAR(4),@PRECIO MONEY
SELECT @CODIGO=INSERTED.CE_CODIGO,@PRECIO= INSERTED.CE_PRECIO FROM INSERTED
update EQUIPOS SET EQ_VALOR_COMPRA= EQ_VALOR_COMPRA+@PRECIO
WHERE @CODIGO=EQ_CODIGO

CREATE  TRIGGER TR_DSPRECIO_EQUIPO 
ON COMPONENTES_X_EQUIPO AFTER DELETE
AS
DECLARE @CODIGO CHAR(4),@PRECIO MONEY
SELECT @CODIGO=DELETED.CE_CODIGO,@PRECIO= DELETED.CE_PRECIO FROM DELETED
update EQUIPOS SET EQ_VALOR_COMPRA= EQ_VALOR_COMPRA-@PRECIO
WHERE @CODIGO=EQ_CODIGO

--CUANDO SE DA DE BAJA A UN COMPONENTE SE DEBE INSERTAR SUS DATOS EN LA TABLA DE BAJAS Y BORRAR SUS DATOS DE LA TABLA COMPONENTES 
--Y OTRAS EN DONDE ESTÉ CONSTANDO ESE COMPONENTE.


--LUEGO DE REALIZAR UN MANTENIMIENTO A UN EQUIPO, EL MISMO DATO QUE SE INGRESA EN EL CAMPO “ESTADO DESPUÉS” SE DEBE COLOCAR EN 
--EL CAMPO ESTADO DE LA TABLA EQUIPO.
CREATE TRIGGER TR_MANTENIMIENTO
ON MANTENIMIENTO AFTER INSERT
AS
DECLARE @CODIGO CHAR(4), @ESTADO_DESPUES VARCHAR(15)
SELECT  @CODIGO=INSERTED.EQ_CODIGOFK, @ESTADO_DESPUES=INSERTED.M_ESTADO_DESPUES FROM INSERTED
UPDATE EQUIPOS SET EQ_ESTADO_ACTUAL=@ESTADO_DESPUES
WHERE EQ_CODIGO=@CODIGO

--LA SUMA DE LOS VALORES DE TODOS LOS COMPONENTES DE UN EQUIPO ES IGUAL AL VALOR DEL EQUIPO
CREATE TRIGGER TR_PRECIO_EQUIPO 
ON COMPONENTES_X_EQUIPO AFTER INSERT
AS
DECLARE @CODIGO CHAR(4),@PRECIO MONEY
SELECT @CODIGO=INSERTED.EQ_CODIGOFK,@PRECIO= INSERTED.CE_PRECIO FROM INSERTED
update EQUIPOS SET EQ_VALOR_COMPRA= EQ_VALOR_COMPRA+@PRECIO
WHERE @CODIGO=EQ_CODIGO

--============================= INSERCIÒN DE DATOS ============================= 

INSERT INTO PROVEEDOR VALUES('P001','Jose','Ayala','1724514809','Software S.A')
INSERT INTO PROVEEDOR VALUES('P002','Maria','Aldaz','1724525819', 'TECpon')
INSERT INTO PROVEEDOR VALUES('P003','Bryan','Cruz','1724589849', 'AsisTec')

INSERT INTO RESPONSABLE VALUES('R001','Marco','Perez','1724514879','Contador')
INSERT INTO RESPONSABLE VALUES('R002','Lorena','Palomino','1824525809', 'Gerente')
INSERT INTO RESPONSABLE VALUES('R003','Iris','Castro','1924589809', 'Directora')

INSERT INTO TECNICO VALUES('T001','Pablo','Teran','1724514812')
INSERT INTO TECNICO VALUES('T002','Susana','Garcia','1624525809')
INSERT INTO TECNICO VALUES('T003','Ambar','Lescano','1557589809')

INSERT INTO EQUIPOS VALUES('E001','DELL',0,'11/05/2013','1 año', 'Ed.Administrativo 5 piso', 'FC', 'P002')
INSERT INTO EQUIPOS VALUES('E002','DELL',0,'10/06/2013','2 año', 'Ed.Administrativo 4 piso', 'FC', 'P003')
INSERT INTO EQUIPOS VALUES('E003','DELL',0,'03/12/2014','Medio año', 'Direccion 3 piso', 'FC', 'P002')
INSERT INTO EQUIPOS VALUES('E004','DELL',0,'11/02/2014','1 año', 'Ed.Administrativo 5 piso', 'MT', 'P003')
INSERT INTO EQUIPOS VALUES('E005','DELL',0,'05/01/2014','2 año', 'Ed.Administrativo 5 piso', 'FC', 'P003')
INSERT INTO EQUIPOS VALUES('E006','DELL',0,'07/04/2015','2 año', 'Ed.Administrativo 5 piso', 'MT', 'P002')
INSERT INTO EQUIPOS VALUES('E007','DELL',0,'11/10/2015','Medio año', 'Ed.Administrativo 5 piso', 'FC', 'P001')
INSERT INTO EQUIPOS VALUES('E008','DELL',0,'10/11/2015','1 año', 'Ed.Administrativo 5 piso', 'MT', 'P003')
INSERT INTO EQUIPOS VALUES('E009','DELL',0,'06/11/2015','1 año', 'Ed.Administrativo 5 piso', 'FC', 'P002')
INSERT INTO EQUIPOS VALUES('E010','DELL',0,'01/04/2015','2 año', 'Ed.Administrativo 5 piso', 'FC', 'P001')
INSERT INTO EQUIPOS VALUES('E011','DELL',0,'28/11/2013','1 año', 'Ed.Administrativo 5 piso', 'FC', 'P002')
INSERT INTO EQUIPOS VALUES('E012','DELL',0,'10/06/2013','2 año', 'Ed.Administrativo 4 piso', 'FC', 'P003')
INSERT INTO EQUIPOS VALUES('E013','DELL',0,'03/12/2014','Medio año', 'Direccion 3 piso', 'FC', 'P002')
INSERT INTO EQUIPOS VALUES('E014','DELL',0,'11/02/2014','1 año', 'Ed.Administrativo 5 piso', 'MT', 'P003')
INSERT INTO EQUIPOS VALUES('E015','DELL',0,'05/01/2014','2 año', 'Ed.Administrativo 5 piso', 'FC', 'P003')
INSERT INTO EQUIPOS VALUES('E016','DELL',0,'07/04/2015','2 año', 'Ed.Administrativo 5 piso', 'MT', 'P002')
INSERT INTO EQUIPOS VALUES('E017','DELL',0,'11/10/2015','Medio año', 'Ed.Administrativo 5 piso', 'FC', 'P001')
INSERT INTO EQUIPOS VALUES('E018','DELL',0,'10/11/2014','1 año', 'Ed.Administrativo 5 piso', 'MT', 'P003')
INSERT INTO EQUIPOS VALUES('E019','DELL',0,'06/11/2014','1 año', 'Ed.Administrativo 5 piso', 'FC', 'P002')
INSERT INTO EQUIPOS VALUES('E020','DELL',0,'01/04/2014','2 año', 'Ed.Administrativo 5 piso', 'FC', 'P001')


INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR01','04/04/2014','R001','E001')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR02','05/05/2014','R002','E002')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR03','07/06/2014','R003','E003')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR04','08/06/2014','R001','E004')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR05','07/07/2014','R003','E005')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR06','07/09/2014','R002','E006')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR07','07/10/2014','R002','E007')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR08','07/11/2014','R003','E008')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR09','10/11/2014','R001','E009')
INSERT INTO CAMBIO_RESPONSABLE VALUES ('CR10','07/12/2014','R003','E010')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C001','MOUSE',0,3.8,8,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C002','MONITOR',0,16,70.66,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C003','TECLADO',0,8,15,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C004','DISCO DURO',500,4,150.48,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C005','TARJETA DE RED',0,1.5,100.69,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C006','CPU',0,0.8,80,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C007','PLACA PRINCIPAL',400,2,200,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C008','RAM',128,2,50,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C009','FUENTE DE ALIMENTACIÒN',0,2.6,15,'E001')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C010','TARJETA DE VIDEO',2,0.6,35,'E001')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C011','MOUSE',0,3.8,10,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C012','MONITOR',0,20,80,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C013','TECLADO',0,6,10,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C014','DISCO DURO',1000,5,154.47,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C015','TARJETA DE RED',0,2,87.90,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C016','CPU',0,2,88,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C017','PLACA PRINCIPAL',300,2.5,150,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C018','RAM',256,3,30,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C019','FUENTE DE ALIMENTACIÒN',0,3,12,'E002')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C020','TARJETA DE VIDEO',4,0.9,45,'E002')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C021','MOUSE',0,2,10,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C022','MONITOR',0,16,39.66,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C023','TECLADO',0,5,12,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C024','DISCO DURO',250,3,90,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C025','TARJETA DE RED',0,2,88.60,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C026','CPU',0,2,46,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C027','PLACA PRINCIPAL',120,3,192,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C028','RAM',256,2.5,75,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C029','FUENTE DE ALIMENTACIÒN',0,3,22,'E003')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C030','TARJETA DE VIDEO',2,0.6,22,'E003')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C031','MOUSE',0,3.8,10,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C032','MONITOR',0,16,70,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C033','TECLADO',0,8,20,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C034','DISCO DURO',2000,4,130,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C035','TARJETA DE RED',0,1.5,60,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C036','CPU',0,0.8,78,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C037','PLACA PRINCIPAL',320,2,100,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C038','RAM',512,2,75,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C039','FUENTE DE ALIMENTACIÒN',0,2.6,10,'E004')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C040','TARJETA DE VIDEO',4,0.6,45,'E004')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C041','MOUSE',0,3.8,12,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C042','MONITOR',0,16,14,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C043','TECLADO',0,8,10,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C044','DISCO DURO',256,4,100.34,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C045','TARJETA DE RED',0,1.5,40,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C046','CPU',0,0.8,45,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C047','PLACA PRINCIPAL',320,2,170,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C048','RAM',256,2,60,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C049','FUENTE DE ALIMENTACIÒN',0,2.6,14,'E005')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C050','TARJETA DE VIDEO',4,0.6,23,'E005')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C051','MOUSE',0,3.8,12,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C052','MONITOR',0,16,100,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C053','TECLADO',0,8,10,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C054','DISCO DURO',2000,4,180,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C055','TARJETA DE RED',0,1.5,101.35,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C056','CPU',0,0.8,67,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C057','PLACA PRINCIPAL',400,2,230,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C058','RAM',128,2,28,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C059','FUENTE DE ALIMENTACIÒN',0,2.6,10,'E006')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C060','TARJETA DE VIDEO',2,0.6,45,'E006')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C061','MOUSE',0,3.8,15,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C062','MONITOR',0,16,58.90,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C063','TECLADO',0,8,10,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C064','DISCO DURO',500,4,150.90,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C065','TARJETA DE RED',0,1.5,45,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C066','CPU',0,0.8,45,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C067','PLACA PRINCIPAL',350,2,120,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C068','RAM',256,2,43,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C069','FUENTE DE ALIMENTACIÒN',0,2.6,25,'E007')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C070','TARJETA DE VIDEO',1,0.6,40,'E007')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C071','MOUSE',0,3.8,8,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C072','MONITOR',0,16,70.66,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C073','TECLADO',0,8,15,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C074','DISCO DURO',500,4,150.48,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C075','TARJETA DE RED',0,1.5,100.69,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C076','CPU',0,0.8,80,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C077','PLACA PRINCIPAL',400,2,200,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C078','RAM',128,2,50,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C079','FUENTE DE ALIMENTACIÒN',0,2.6,15,'E008')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C080','TARJETA DE VIDEO',2,0.6,35,'E008')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C081','MOUSE',0,3.8,12,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C082','MONITOR',0,16,80.45,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C083','TECLADO',0,8,20,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C084','DISCO DURO',256,4,120.22,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C085','TARJETA DE RED',0,1.5,80,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C086','CPU',0,0.8,76,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C087','PLACA PRINCIPAL',100,2,100.56,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C088','RAM',512,2,75,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C089','FUENTE DE ALIMENTACIÒN',0,2.6,14,'E009')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C090','TARJETA DE VIDEO',4,0.6,30,'E009')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C091','MOUSE',0,3.8,12,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C092','MONITOR',0,16,90.76,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C093','TECLADO',0,8,13,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C094','DISCO DURO',1000,4,120,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C095','TARJETA DE RED',0,1.5,58,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C096','CPU',0,0.8,67,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C097','PLACA PRINCIPAL',400,2,120,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C098','RAM',256,2,46,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C099','FUENTE DE ALIMENTACIÒN',0,2.6,20,'E010')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C100','TARJETA DE VIDEO',1,0.6,50,'E010')


INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C101','MOUSE',0,3.8,12,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C102','MONITOR',0,16,90.76,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C103','TECLADO',0,8,13,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C104','DISCO DURO',1000,4,120,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C105','TARJETA DE RED',0,1.5,58,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C106','CPU',0,0.8,67,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C107','PLACA PRINCIPAL',400,2,120,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C108','RAM',256,2,46,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C109','FUENTE DE ALIMENTACIÒN',0,2.6,20,'E011')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C110','TARJETA DE VIDEO',1,0.6,50,'E011')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C111','MOUSE',0,3.8,10,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C112','MONITOR',0,20,80,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C113','TECLADO',0,6,10,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C114','DISCO DURO',1000,5,154.47,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C115','TARJETA DE RED',0,2,87.90,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C116','CPU',0,2,88,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C117','PLACA PRINCIPAL',300,2.5,150,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C118','RAM',256,3,30,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C119','FUENTE DE ALIMENTACIÒN',0,3,12,'E012')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C120','TARJETA DE VIDEO',4,0.9,45,'E012')


INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C121','MOUSE',0,2,10,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C122','MONITOR',0,16,39.66,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C123','TECLADO',0,5,12,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C124','DISCO DURO',250,3,90,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C125','TARJETA DE RED',0,2,88.60,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C126','CPU',0,2,46,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C127','PLACA PRINCIPAL',120,3,192,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C128','RAM',256,2.5,75,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C129','FUENTE DE ALIMENTACIÒN',0,3,22,'E013')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C130','TARJETA DE VIDEO',2,0.6,22,'E013')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C131','MOUSE',0,3.8,10,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C132','MONITOR',0,16,70,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C133','TECLADO',0,8,20,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C134','DISCO DURO',2000,4,130,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C135','TARJETA DE RED',0,1.5,60,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C136','CPU',0,0.8,78,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C137','PLACA PRINCIPAL',320,2,100,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C138','RAM',512,2,75,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C139','FUENTE DE ALIMENTACIÒN',0,2.6,10,'E014')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C140','TARJETA DE VIDEO',4,0.6,45,'E014')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C141','MOUSE',0,3.8,12,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C142','MONITOR',0,16,14,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C143','TECLADO',0,8,10,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C144','DISCO DURO',256,4,100.34,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C145','TARJETA DE RED',0,1.5,40,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C146','CPU',0,0.8,45,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C147','PLACA PRINCIPAL',320,2,170,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C148','RAM',256,2,60,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C149','FUENTE DE ALIMENTACIÒN',0,2.6,14,'E015')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C150','TARJETA DE VIDEO',4,0.6,23,'E015')


INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C151','MOUSE',0,3.8,12,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C152','MONITOR',0,16,100,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C153','TECLADO',0,8,10,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C154','DISCO DURO',2000,4,180,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C155','TARJETA DE RED',0,1.5,101.35,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C156','CPU',0,0.8,67,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C157','PLACA PRINCIPAL',400,2,230,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C158','RAM',128,2,28,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C159','FUENTE DE ALIMENTACIÒN',0,2.6,10,'E016')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C160','TARJETA DE VIDEO',2,0.6,45,'E016')


INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C161','MOUSE',0,3.8,15,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C162','MONITOR',0,16,58.90,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C163','TECLADO',0,8,10,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C164','DISCO DURO',500,4,150.90,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C165','TARJETA DE RED',0,1.5,45,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C166','CPU',0,0.8,45,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C167','PLACA PRINCIPAL',350,2,120,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C168','RAM',256,2,43,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C169','FUENTE DE ALIMENTACIÒN',0,2.6,25,'E017')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C170','TARJETA DE VIDEO',1,0.6,40,'E017')


INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C171','MOUSE',0,3.8,8,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C172','MONITOR',0,16,70.66,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C173','TECLADO',0,8,15,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C174','DISCO DURO',500,4,150.48,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C175','TARJETA DE RED',0,1.5,100.69,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C176','CPU',0,0.8,80,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C177','PLACA PRINCIPAL',400,2,200,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C178','RAM',128,2,50,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C179','FUENTE DE ALIMENTACIÒN',0,2.6,15,'E018')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C180','TARJETA DE VIDEO',2,0.6,35,'E018')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C181','MOUSE',0,3.8,12,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C182','MONITOR',0,16,80.45,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C183','TECLADO',0,8,20,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C184','DISCO DURO',256,4,120.22,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C185','TARJETA DE RED',0,1.5,80,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C186','CPU',0,0.8,76,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C187','PLACA PRINCIPAL',100,2,100.56,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C188','RAM',512,2,75,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C189','FUENTE DE ALIMENTACIÒN',0,2.6,14,'E019')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C190','TARJETA DE VIDEO',4,0.6,30,'E019')

INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C191','MOUSE',0,3.8,12,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C192','MONITOR',0,16,90.76,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C193','TECLADO',0,8,13,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C194','DISCO DURO',1000,4,120,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C195','TARJETA DE RED',0,1.5,58,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C196','CPU',0,0.8,67,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C197','PLACA PRINCIPAL',400,2,120,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C198','RAM',256,2,46,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C199','FUENTE DE ALIMENTACIÒN',0,2.6,20,'E020')
INSERT INTO COMPONENTES_X_EQUIPO VALUES ('C200','TARJETA DE VIDEO',1,0.6,50,'E020')


INSERT INTO COMPONENTES_ADICIONALES VALUES ('A001','DELL','MOUSE',0,3.8,8,'01/04/2014','1 año',10)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A002','DELL','MONITOR',0,16,70.66,'11/04/2014','2 año',100)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A003','DELL','TECLADO',0,8,15,'10/04/2014','1 año',150)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A004','DELL','DISCO DURO',500,4,150.48,'05/06/2014','1 año',150)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A005','DELL','TARJETA DE RED',0,1.5,100.69,'06/06/2014','1 año',60)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A006','DELL','CPU',0,0.8,80,'07/08/2014','1 año',250)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A007','DELL','PLACA PRINCIPAL',400,2,200,'03/09/2014','1 año',200)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A008','DELL','RAM',128,2,50,'02/09/2014','1 año',90)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A009','DELL','FUENTE DE ALIMENTACIÒN',0,2.6,15,'08/10/2014','2 año',120)
INSERT INTO COMPONENTES_ADICIONALES VALUES ('A010','DELL','TARJETA DE VIDEO',2,0.6,35,'05/11/2014','1 año',80)

INSERT INTO MANTENIMIENTO VALUES('M021','12/01/2014','Cambio de tarjeta de Red','DN', 'DN', 'T002','E001')
INSERT INTO MANTENIMIENTO VALUES('M002','12/02/2014','Cambio de tarjeta de Red','DN', 'FC', 'T001','E001')

INSERT INTO MANTENIMIENTO VALUES('M003','03/12/2014','Cambio de tarjeta de Red','MT', 'FC', 'T003','E002')
INSERT INTO MANTENIMIENTO VALUES('M004','01/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T002','E002')

INSERT INTO MANTENIMIENTO VALUES('M005','04/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T002','E003')
INSERT INTO MANTENIMIENTO VALUES('M006','05/12/2014','Cambio de tarjeta de Red','MT', 'FC', 'T001','E003')

INSERT INTO MANTENIMIENTO VALUES('M007','06/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T002','E004')
INSERT INTO MANTENIMIENTO VALUES('M008','07/12/2014','Cambio de tarjeta de Red','FC', 'DN', 'T003','E004')

INSERT INTO MANTENIMIENTO VALUES('M009','08/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T001','E005')
INSERT INTO MANTENIMIENTO VALUES('M010','12/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T002','E005')

INSERT INTO MANTENIMIENTO VALUES('M011','09/12/2014','Cambio de tarjeta de Red','DN', 'DN', 'T001','E006')
INSERT INTO MANTENIMIENTO VALUES('M012','07/12/2014','Cambio de tarjeta de Red','MT', 'FC', 'T002','E006')

INSERT INTO MANTENIMIENTO VALUES('M013','05/12/2014','Cambio de tarjeta de Red','DN', 'DN', 'T001','E007')
INSERT INTO MANTENIMIENTO VALUES('M014','06/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T003','E007')

INSERT INTO MANTENIMIENTO VALUES('M015','02/12/2014','Cambio de tarjeta de Red','MT', 'FC', 'T001','E008')
INSERT INTO MANTENIMIENTO VALUES('M016','01/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T002','E008')

INSERT INTO MANTENIMIENTO VALUES('M017','12/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T002','E009')
INSERT INTO MANTENIMIENTO VALUES('M018','11/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T001','E009')

INSERT INTO MANTENIMIENTO VALUES('M019','12/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T002','E010')
INSERT INTO MANTENIMIENTO VALUES('M020','10/12/2014','Cambio de tarjeta de Red','DN', 'FC', 'T003','E010')

INSERT INTO REEMPLAZO_DE_COMPONENTES VALUES('RC01','A001','C010','M002')
INSERT INTO REEMPLAZO_DE_COMPONENTES VALUES('RC02','A002','C011','M007')
INSERT INTO REEMPLAZO_DE_COMPONENTES VALUES('RC03','A001','C009','M012')
INSERT INTO REEMPLAZO_DE_COMPONENTES VALUES('RC04','A003','C005','M013')
INSERT INTO REEMPLAZO_DE_COMPONENTES VALUES('RC05','A004','C006','M016')

INSERT INTO DE_BAJA VALUES('B001','12/12/2014','Dañado')
INSERT INTO DE_BAJA VALUES('B002','12/05/2014','Dañado')
INSERT INTO DE_BAJA VALUES('B003','12/06/2014','Dañado')
INSERT INTO DE_BAJA VALUES('B004','12/09/2014','Dañado') 


--============================= 3.-REALIZAR LAS SIGUIENTES CONSULTAS EN SQL =============================

--LISTAR EL NOMBRE Y APELLIDO DE LOS RESPONSABLES, Y CÓDIGO DE LOS EQUIPOS QUE HAN SIDO ADQUIRIDOS EN LOS ÚLTIMOS 6 MESES.

SELECT R.EQ_CODIGOFK,RP.RP_NOMBRE,RP.RP_APELLIDO FROM RESPONSABLE RP inner join CAMBIO_RESPONSABLE R ON R.RP_CODIGOFK=RP.RP_CODIGO inner join EQUIPOS E ON E.EQ_CODIGO=R.EQ_CODIGOFK
WHERE  MONTH(GETDATE() )-MONTH(E.EQ_FECHA_COMPRA)<6 AND YEAR(GETDATE())-YEAR(E.EQ_FECHA_COMPRA)<1

--LISTADO DE EQUIPOS DAÑADOS JUNTO CON SU REPORTE DE MANTENIMIENTO.

SELECT E.EQ_CODIGO ,M.M_CODIGO,M.M_FECHA, M.M_TRABAJO_REALIZADO, M.M_ESTADO_ANTERIOR, M.M_ESTADO_DESPUES FROM EQUIPOS E INNER JOIN MANTENIMIENTO M ON M.EQ_CODIGOFK=E.EQ_CODIGO
WHERE M.M_ESTADO_ANTERIOR='DN'

--SELECCIONAR CODIGO Y UBICACION DE EQUIPOS QUE TIENEN DISCO DURO DE 500 GB O MÀS

SELECT E.EQ_CODIGO,E.EQ_UBICACIÓN_FISICA FROM EQUIPOS e inner join COMPONENTES_X_EQUIPO c ON E.EQ_CODIGO=c.EQ_CODIGOFK
WHERE CE_CAPACIDAD  > 500 AND C.CE_NOMBRE='DISCO DURO'

--CALCULAR EL VALOR TOTAL DEL INVENTARIO.
DECLARE @TOTAL1 DECIMAL(8,2),@TOTAL2 DECIMAL(8,2),@INVENTARIO DECIMAL(8,2)
SELECT @TOTAL1=SUM(CE.CE_PRECIO)FROM COMPONENTES_X_EQUIPO CE
SELECT @TOTAL2=SUM(CA.CA_PRECIO)FROM COMPONENTES_ADICIONALES CA
SET @INVENTARIO=@TOTAL1+@TOTAL2
SELECT INVENTARIO_TOTAL=@INVENTARIO

--============================= 5.-PROCEDIMIENTOS ALMACENADOS =============================

--DESPLEGAR TODOS LOS DATOS DE LOS EQUIPOS COMPRADOS A UN PROVEEDOR, INGRESANDO COMO PARÁMETRO EL NOMBRE DE PROVEEDOR.
CREATE PROC SP_DATOS_EQUIPO  @NOMBRE VARCHAR (25),@APELLIDO VARCHAR(25)
AS
SELECT E.EQ_MARCA, E.EQ_VALOR_COMPRA, E.EQ_FECHA_COMPRA, E.EQ_PERIODO_GARANTIA, E.EQ_UBICACIÓN_FISICA,E.EQ_ESTADO_ACTUAL FROM EQUIPOS E INNER JOIN PROVEEDOR R
ON E.PR_CODIGOFK=R.PR_CODIGO
WHERE @NOMBRE=R.PR_NOMBRE AND @APELLIDO=R.PR_APELLIDO

EXEC SP_DATOS_EQUIPO 'JOSE','AYALA'
EXEC SP_DATOS_EQUIPO 'BRYAN','CRUZ'
EXEC SP_DATOS_EQUIPO 'MARIA','ALDAZ'

--HACER UN PROCEDIMIENTO ALMACENADO QUE CALCULE EL VALOR TOTAL DEL INVENTARIO.
CREATE PROC SP_INVENTARIO_TOTAL
AS
DECLARE @TOTAL1 DECIMAL(8,2),@TOTAL2 DECIMAL(8,2),@INVENTARIO DECIMAL(8,2)
SELECT @TOTAL1=SUM(CE.CE_PRECIO)FROM COMPONENTES_X_EQUIPO CE
SELECT @TOTAL2=SUM(CA.CA_PRECIO)FROM COMPONENTES_ADICIONALES CA
SET @INVENTARIO=@TOTAL1+@TOTAL2
SELECT INVENTARIO_TOTAL=@INVENTARIO

EXEC SP_INVENTARIO_TOTAL

--EQUIPOS Y UBICACIÓN DE LOS EQUIPOS QUE ESTÁN A CARGO DE UNA PERSONA CUYO NOMBRE SE INGRESA COMO PARÁMETRO.

CREATE PROC SP_UBICACION_RESPONSABLE @NOMBRE VARCHAR (25),@APELLIDO VARCHAR(25)
AS
SELECT E.EQ_CODIGO,E.EQ_UBICACIÓN_FISICA  FROM EQUIPOS E INNER JOIN CAMBIO_RESPONSABLE R
ON E.EQ_CODIGO=R.EQ_CODIGOFK INNER JOIN RESPONSABLE RP ON R.RP_CODIGOFK=RP.RP_CODIGO
WHERE @NOMBRE=RP.RP_NOMBRE AND @APELLIDO=RP.RP_APELLIDO

EXEC SP_UBICACION_RESPONSABLE 'MARCO','PEREZ'
EXEC SP_UBICACION_RESPONSABLE 'IRIS','CASTRO'
EXEC SP_UBICACION_RESPONSABLE 'LORENA','PALOMINO'


--DESPLEGAR TODOS LOS COMPONENTES DE UN EQUIPO CON SUS CARACTERÍSTICAS TÉCNICAS, INGRESADO COMO PARÁMETRO EL CÓDIGO DEL EQUIPO

CREATE PROC SP_EQUIPO_CARACTERISTICAS @CODIGO CHAR(4)
AS
SELECT COMPONENTE=C.CE_NOMBRE,C.CE_CAPACIDAD,C.CE_TAMAÑO,C.CE_PRECIO
FROM EQUIPOS E INNER JOIN COMPONENTES_X_EQUIPO C ON E.EQ_CODIGO=C.EQ_CODIGOFK
WHERE EQ_CODIGO=@CODIGO

EXEC SP_EQUIPO_CARACTERISTICAS 'E007'

--============================= 6.- VISTAS =============================
--HACER UNA VISTA QUE DESPLIEGUE CADA EQUIPO CON TODOS LOS DETALLES DE SUS MANTENIMIENTOS.
CREATE  VIEW V_MANTENIMIENTO_EQUIPO
AS
SELECT E.EQ_CODIGO, M.M_CODIGO, M.M_FECHA, M.M_TRABAJO_REALIZADO, M.M_ESTADO_ANTERIOR, M.M_ESTADO_DESPUES, T.TC_NOMBRE, T.TC_APELLIDO FROM EQUIPOS E INNER JOIN MANTENIMIENTO M ON M.EQ_CODIGOFK=E.EQ_CODIGO
INNER JOIN TECNICO T ON T.TC_CODIGO=M.TC_CODIGOFK 

SELECT*FROM V_MANTENIMIENTO_EQUIPO

